<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Receitas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Cadastro de Receitas</h1>

<!-- Criar receita -->
<h2>Criar</h2>
<input type="text" id="titulo" placeholder="Título"><br>
<textarea id="ingredientes" placeholder="Ingredientes"></textarea><br>
<textarea id="modoPreparo" placeholder="Modo de Preparo"></textarea><br>
<button onclick="criar()">Salvar</button>

<hr>

<!-- Buscar receita -->
<h2>Buscar</h2>
<input type="text" id="buscarTitulo" placeholder="Título da Receita">
<button onclick="buscar()">Buscar</button>
<pre id="resultadoBuscar"></pre>

<hr>

<!-- Deletar receita -->
<h2>Deletar</h2>
<input type="text" id="deletarTitulo" placeholder="Título da Receita">
<button onclick="deletar()">Deletar</button>

<hr>

<!-- Atualizar receita -->
<h2>Atualizar</h2>
<input type="number" id="id" placeholder="ID"><br>
<input type="text" id="novoTitulo" placeholder="Novo Título"><br>
<textarea id="novosIngredientes" placeholder="Novos Ingredientes"></textarea><br>
<textarea id="novoModoPreparo" placeholder="Novo Modo de Preparo"></textarea><br>
<button onclick="atualizar()">Atualizar</button>

<script>
    const api = "/receita";

    async function criar() {
        const resp = await fetch(api, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                titulo: document.getElementById("titulo").value,
                ingredientes: document.getElementById("ingredientes").value,
                modoPreparo: document.getElementById("modoPreparo").value
            })
        });
        alert(resp.ok ? "Receita criada!" : "Erro ao criar!");
    }

    async function buscar() {
        const titulo = document.getElementById("buscarTitulo").value;
        const resp = await fetch(`${api}?titulo=${encodeURIComponent(titulo)}`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "Receita não encontrada!";
        }
    }

    async function deletar() {
        const titulo = document.getElementById("deletarTitulo").value;
        const resp = await fetch(`${api}?titulo=${encodeURIComponent(titulo)}`, { method: "DELETE" });
        alert(resp.ok ? "Receita deletada!" : "Erro ao deletar!");
    }

    async function atualizar() {
        const id = document.getElementById("id").value;
        const resp = await fetch(`${api}?id=${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                titulo: document.getElementById("novoTitulo").value,
                ingredientes: document.getElementById("novosIngredientes").value,
                modoPreparo: document.getElementById("novoModoPreparo").value
            })
        });
        alert(resp.ok ? "Receita atualizada!" : "Erro ao atualizar!");
    }
</script>
</body>
</html>
